# 🔗 Google Sheets 하이브리드 연결 가이드

이 가이드는 기존 엑셀 파일을 Google Sheets로 변환하고 하이브리드 환수 관리 시스템에 연결하는 방법을 설명합니다.

## 📋 1단계: 엑셀 파일을 Google Sheets로 업로드

### 1.1 Google Drive 접속
1. 웹 브라우저에서 **drive.google.com** 접속
2. 구글 계정으로 로그인

### 1.2 엑셀 파일 업로드
1. **"새로 만들기"** 버튼 클릭
2. **"파일 업로드"** 선택
3. **"환수 진행 내역 및 현황.xlsx"** 파일 선택하여 업로드
4. 업로드 완료 대기 (파일 크기에 따라 1-2분 소요)

### 1.3 Google Sheets로 변환
1. 업로드된 파일을 **더블클릭**
2. **"Google Sheets로 열기"** 버튼 클릭
3. 변환 완료 대기 (자동으로 .gsheet 파일로 변환됨)

## 🌐 2단계: CSV 공개 설정

### 2.1 웹에 게시 설정
1. Google Sheets에서 **"파일"** 메뉴 클릭
2. **"공유"** → **"웹에 게시"** 선택
3. 게시 형식을 **"쉼표로 구분된 값(.csv)"** 선택
4. **"게시"** 버튼 클릭
5. **"확인"** 클릭하여 공개 설정 완료

### 2.2 시트 ID 확인
1. 브라우저 주소창에서 URL 확인
2. URL 형식: `https://docs.google.com/spreadsheets/d/[시트ID]/edit`
3. `[시트ID]` 부분을 복사 (예: `1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms`)

**예시:**
```
URL: https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
시트 ID: 1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms
```

## 🔧 3단계: 대시보드 연결

### 3.1 환경변수 설정 (선택사항)
로컬에서 개발하는 경우:
1. `.env.example` 파일을 `.env`로 복사
2. `VITE_GOOGLE_SHEET_ID` 값을 실제 시트 ID로 설정

### 3.2 대시보드에서 연결
1. 대시보드 로그인 후 **"설정"** 버튼 클릭
2. **"Google Sheets 연결 설정"** 선택
3. 복사한 **시트 ID** 입력
4. **"연결 완료"** 클릭

## 📊 4단계: 데이터 구조 확인

### 4.1 필수 컬럼
Google Sheets에 다음 컬럼들이 포함되어야 합니다:

| 컬럼명 | 대체명 | 설명 | 예시 |
|--------|---------|------|------|
| ID | 번호 | 고유 식별자 | 001, 002, 003 |
| 차용자 | 이름, 성명 | 차용자명 | 김철수, 이영희 |
| 대출금액 | 환수요청금액 | 원금 | 1000000 |
| 잔여금액 | 미상환금액 | 남은 금액 | 500000 |
| 대출일 | 대출_일자 | 대출 시작일 | 2024-01-15 |
| 상환예정일 | 상환_예정일 | 상환 마감일 | 2025-01-15 |
| 주민번호 | 주민번호_앞자리 | 개인식별정보 | 123456-1234567 |
| 연락처 | 휴대폰 | 전화번호 | 010-1234-5678 |
| 비고 | 메모 | 기타 정보 | 정상 상환 중 |

### 4.2 날짜 형식
지원되는 날짜 형식:
- `YYYY-MM-DD` (권장): 2024-01-15
- `YYYY.MM.DD`: 2024.01.15
- `YYYY/MM/DD`: 2024/01/15
- `MM/DD/YYYY`: 01/15/2024

### 4.3 금액 형식
지원되는 금액 형식:
- 숫자만: `1000000`
- 쉼표 포함: `1,000,000`
- 원화 표시: `₩1,000,000`
- 기타 기호: `$1,000,000`

## 🔄 5단계: 실시간 동기화 확인

### 5.1 동기화 테스트
1. Google Sheets에서 데이터 수정
2. 대시보드에서 **"실시간 동기화"** 버튼 클릭
3. 변경사항이 즉시 반영되는지 확인

### 5.2 자동 새로고침 설정
- 대시보드는 기본적으로 30초마다 자동 새로고침
- 환경변수 `VITE_DATA_REFRESH_INTERVAL`로 조정 가능

## 🛡️ 6단계: 보안 및 권한 설정

### 6.1 시트 접근 권한
- **읽기 전용**: 링크가 있는 모든 사용자가 볼 수 있음
- **편집 금지**: CSV 읽기만 가능, 직접 편집 불가
- **안전한 공개**: API 키 없이도 안전한 데이터 접근

### 6.2 사용자 권한 관리
대시보드에서 사용자별 권한 설정:
- **관리자**: 읽기, 쓰기, 삭제, 사용자 관리
- **팀장**: 읽기, 쓰기
- **조회자**: 읽기만 가능

## ⚠️ 문제 해결

### 문제 1: "데이터를 불러올 수 없습니다"
**원인**: 시트 ID가 잘못되었거나 공개 설정이 안됨
**해결책**:
1. 시트 ID 다시 확인
2. "웹에 게시" 설정 다시 확인
3. CSV 형식으로 게시되었는지 확인

### 문제 2: "일부 데이터가 표시되지 않습니다"
**원인**: 컬럼명이 일치하지 않음
**해결책**:
1. 필수 컬럼명 확인
2. 대소문자 및 띄어쓰기 확인
3. 한글/영문 컬럼명 혼용 확인

### 문제 3: "동기화가 느립니다"
**원인**: 네트워크 지연 또는 대용량 데이터
**해결책**:
1. 불필요한 컬럼 제거
2. 브라우저 캐시 삭제
3. 안정적인 네트워크 환경 확인

## 🎯 완료 확인 체크리스트

- [ ] ✅ 엑셀 파일이 Google Sheets로 변환됨
- [ ] ✅ CSV 웹 게시 설정 완료
- [ ] ✅ 시트 ID 복사 및 대시보드 연결
- [ ] ✅ 필수 컬럼들이 모두 존재함
- [ ] ✅ 샘플 데이터가 올바르게 표시됨
- [ ] ✅ 실시간 동기화가 정상 작동함
- [ ] ✅ 사용자 권한이 올바르게 설정됨

## 📞 지원 및 문의

하이브리드 시스템 연결에 문제가 있으시면:
1. 브라우저 개발자 도구 → 콘솔 탭에서 오류 메시지 확인
2. GitHub Issues에 문제 상황 설명
3. 시트 구조 스크린샷 첨부

---

**🎉 축하합니다!** 
하이브리드 환수 관리 시스템이 성공적으로 연결되었습니다. 
이제 엑셀의 편리함과 웹 대시보드의 실시간성을 모두 누리실 수 있습니다!
